============
Commands 
============

BWA & Samtools
==============

**Alignment, SAM/BAM conversion and indexing**::

 	bwa mem -t 16 <reference> <fastq1> <fastq2> | samtools view -Sb - | \
	samtools sort - <output> && samtools index <BAM file>


Picard
======

**Deduplication**::

	picard MarkDuplicates INPUT=<BAM file> OUTPUT=<dedup BAM file> METRICS_FILE=<metrics file>

**Adding headers**::

	picard AddOrReplaceReadGroups INPUT=<dedup BAM> OUTPUT=<good BAM> RGSM=<patient ID> \
	RGLB=Test RGPL=illumina RGPU=none

**Generate coverage information**::

	picard CollectHsMetrics BI=<bait file> I=<recal_reads BAM> PER_BASE_COVERAGE=<nucl.out file> \
	MINIMUM_MAPPING_QUALITY=0 MINIMUM_BASE_QUALITY=0 TARGET_INTERVALS=<bait file> \
	OUTPUT=<out file> R=<reference>


GATK3
=====

**Create realignment targets**::


	java -jar /usr/local/bin/GenomeAnalysisTK.jar -T RealignerTargetCreator -R <reference>\
	-I <good BAM> -known <VCF file> -o realignment_targets.list -nt 4 -L <BED file>


**Perform indel realignment**::

	java -jar /usr/local/bin/GenomeAnalysisTK.jar -T IndelRealigner -R <reference> -I <good BAM> \
	-targetIntervals realignment_targets.list -known <VCF file> -o <realigned BAM>

**Create base recalibration table**::

	java -jar /usr/local/bin/GenomeAnalysisTK.jar -T BaseRecalibrator -R <reference>  -I <realigned BAM> \
	-knownSites <VCF file> -o recal_data.table -nct 4 -L <BED file>

**Analyse marked bases for recalibration**::

	java -jar /usr/local/bin/GenomeAnalysisTK.jar -T BaseRecalibrator -R <reference> -I <realigned BAM> \
	-knownSites <VCF file> -BQSR recal_data.table -o post_recal_data.table -nct 4

**Perform recalibration**::

	java -jar /usr/local/bin/GenomeAnalysisTK.jar -T PrintReads -R <reference> -I <realigned BAM> \
	-BQSR recal_data.table -o <recal_reads BAM

**Calling variants (HaplotypeCaller)**::

	java -jar /usr/local/bin/GenomeAnalysisTK.jar -T HaplotypeCaller -R <reference> -I <recal_reads BAM> \
	--genotyping_mode DISCOVERY -stand_emit_conf 10 -stand_call_conf 30 -o raw_variants.vcf -L <BED file>


Freebayes
=========

**Calling variants**::

	freebayes -f <reference> -v freebayes.vcf -t <BED file> <recal_reads BAM>


Octopus
=======





Deprecated
**********

Platypus
========

**Calling variants**::

	/opt/Platypus_0.8.1/Platypus.py callVariants --refFile=<reference> --bamFiles=<recal_reads BAM> --nCPU=8 \
	--regions=<BED file> -o platypus.vcf

Atlas-Indel2
============

**Calling indel variants**::

	ruby /opt/Atlas-Indel2/Atlas-Indel2.rb -b <recal_reads BAM> -r <reference> -o atlas.vcf -B <BED file> -I' % (argument, reference, argument2, bed_file)


.. toctree::
   :maxdepth: 5


Indices and tables
==================

* :ref:`genindex`
* :ref:`modindex`
* :ref:`search`
  
.. _Genome Analysis Toolkit: https://www.broadinstitute.org/gatk/
.. _Platypus: http://www.well.ox.ac.uk/platypus
.. _Picard: http://broadinstitute.github.io/picard/
.. _BWA: https://github.com/lh3/bwa
.. _Freebayes: https://github.com/ekg/freebayes
.. _Atlas-Indel2: https://www.hgsc.bcm.edu/software/software/atlas-2